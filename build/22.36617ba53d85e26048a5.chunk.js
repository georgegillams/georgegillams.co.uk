(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"./app/containers/MagicLogin/Container.js":function(e,t,n){"use strict";var o=n("./node_modules/@babel/runtime/helpers/interopRequireWildcard.js"),s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(n("./node_modules/@babel/runtime/helpers/extends.js")),a=s(n("./node_modules/@babel/runtime/helpers/jsx.js")),i=s(n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js")),u=s(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),c=s(n("./node_modules/@babel/runtime/helpers/createClass.js")),l=s(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=s(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=s(n("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),g=s(n("./node_modules/@babel/runtime/helpers/inherits.js")),f=s(n("./node_modules/@babel/runtime/helpers/defineProperty.js")),m=s(n("./node_modules/react/index.js")),b=(s(n("./node_modules/prop-types/index.js")),n("./node_modules/react-helmet/lib/Helmet.js")),j=(o(n("./node_modules/bpk-component-image/index.js")),n("./node_modules/bpk-react-utils/index.js")),h=(n("./node_modules/gg-components/LoadingIndicator/index.js"),n("./node_modules/gg-components/Button/index.js"),n("./node_modules/gg-components/Typography/index.js")),x=(n("./node_modules/gg-components/Code/index.js"),n("./node_modules/gg-components/Auth/index.js")),_=(n("./app/components/Forms/index.js"),n("./app/components/Sessions/index.js")),O=n("./node_modules/gg-components/Redirect/index.js"),I=n("./helpers/constants.js"),v=s(n("./app/containers/pages.scss")),y=((0,j.cssModules)(v.default),(0,a.default)(b.Helmet,{title:"Login"})),k=(0,a.default)("text",{},void 0,"Logged in!"),M=function(e){function t(){var e,n;(0,u.default)(this,t);for(var o=arguments.length,s=new Array(o),r=0;r<o;r++)s[r]=arguments[r];return n=(0,l.default)(this,(e=(0,d.default)(t)).call.apply(e,[this].concat(s))),(0,f.default)((0,p.default)(n),"componentDidMount",(function(){var e=setInterval((function(){var t=new URL(window.location).searchParams.get("token");n.props.cookiesAllowed&&(n.props.login(t),clearInterval(e))}),200)})),n}return(0,g.default)(t,e),(0,c.default)(t,[{key:"render",value:function(){var e=this.props,t=e.cookiesAllowed,n=e.onCookiesAccepted,o=e.login,s=e.user,u=e.loggingIn,c=e.logInSuccess,l=e.logInError,d=e.className,p=(0,i.default)(e,["cookiesAllowed","onCookiesAccepted","login","user","loggingIn","logInSuccess","logInError","className"]),g=[];if(d&&g.push(d),c){var f=new URL(window.location).searchParams.get("redirect");return f&&""!==f&&f.match(I.REDIRECT_REGEX)||(f="account"),(0,a.default)(O.GGRedirect,{className:g.join(" "),to:"".concat(I.SITE_URL,"/").concat(f),name:"Logged in"})}return m.default.createElement("div",(0,r.default)({className:g.join(" ")},p),y,(0,a.default)(_.CookiesOnly,{cookiesAccepted:t,onAccept:function(){n()}}),(0,a.default)(h.Section,{name:"Magic login"},void 0,s&&k),(0,a.default)(x.DebugObject,{debugTitle:"Magic login",debugObject:{cookiesAllowed:t,onCookiesAccepted:n,login:o,user:s,loggingIn:u,logInSuccess:c,logInError:l}}))}}]),t}(m.default.Component);t.default=M,e.exports=t.default},"./app/containers/MagicLogin/actionMeta.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o={key:"magicLogin",actionDefinitions:[{LOGIN:"tbd",attributes:["token"],stateMutations:{token:function(e){return e.token},loggingIn:!0,logInError:null}},{LOGIN_REGISTER_SUCCESS:"tbd",attributes:[],stateMutations:{loggingIn:!1,logInSuccess:!0}},{LOGIN_REGISTER_ERROR:"tbd",attributes:["logInError"],stateMutations:{loggingIn:!1,logInSuccess:!1,logInError:function(e){return e.logInError}}}]};t.default=o,e.exports=t.default},"./app/containers/MagicLogin/index.js":function(e,t,n){"use strict";var o=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),s=o(n("./node_modules/@babel/runtime/helpers/defineProperty.js")),r=o(n("./app/containers/App/selectors.js")),a=o(n("./app/containers/App/actions.js")),i=n("./helpers/redux/index.js"),u=o(n("./app/containers/MagicLogin/actionMeta.js")),c=n("./app/containers/MagicLogin/redux-definitions.js"),l=o(n("./app/containers/MagicLogin/saga.js")),d=o(n("./app/containers/MagicLogin/Container.js"));function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,s.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=(0,i.composeContainer)(d.default,u.default.key,g({},c.selectors,{},r.default),g({},c.actions,{appActions:a.default}),c.reducer,l.default)},"./app/containers/MagicLogin/redux-definitions.js":function(e,t,n){"use strict";var o=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),s=o(n("./app/containers/MagicLogin/actionMeta.js")),r=o(n("./helpers/redux/index.js"));e.exports=(0,r.default)(s.default)},"./app/containers/MagicLogin/saga.js":function(e,t,n){"use strict";var o=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.doLogin=h,t.default=x;var s=o(n("./node_modules/@babel/runtime/regenerator/index.js")),r=n("./app/containers/MagicLogin/redux-definitions.js"),a=n("./node_modules/redux-saga/dist/redux-saga-effects-npm-proxy.cjs.js"),i=n("./app/containers/App/actions.js"),u=n("./helpers/constants.js"),c=n("./app/containers/RequestStatusWrapper/actions.js"),l=o(n("./app/utils/request.js")),d=s.default.mark(h),p=s.default.mark(x),g=r.constants.LOGIN,f=r.actions.loginRegisterSuccess,m=r.actions.loginRegisterError,b=r.selectors.makeSelectToken,j={type:"success",message:"Logged in!"};function h(){var e,t,n;return s.default.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,(0,a.select)(b());case 2:return e=o.sent,t="".concat(u.API_ENDPOINT,"/loginmagiclink"),o.prev=4,o.next=7,(0,a.call)(l.default,t,{method:"POST",body:JSON.stringify({magicLinkKey:e}),headers:{"Content-Type":"application/json"}});case 7:if(!(n=o.sent).error){o.next=15;break}return o.next=11,(0,a.put)(m(n));case 11:return o.next=13,(0,a.put)((0,c.pushMessage)({type:"error",message:n.errorMessage}));case 13:o.next=21;break;case 15:return o.next=17,(0,a.put)(f());case 17:return o.next=19,(0,a.put)((0,i.setUser)(n));case 19:return o.next=21,(0,a.put)((0,c.pushMessage)(j));case 21:o.next=29;break;case 23:return o.prev=23,o.t0=o.catch(4),o.next=27,(0,a.put)(m(o.t0));case 27:return o.next=29,(0,a.put)((0,c.pushMessage)(u.COMMUNICATION_ERROR_MESSAGE));case 29:case"end":return o.stop()}}),d,null,[[4,23]])}function x(){return s.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,a.takeLatest)(g,h);case 2:case"end":return e.stop()}}),p)}}}]);