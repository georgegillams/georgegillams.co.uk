{"version":3,"sources":["../../../server/middlewares/addDevMiddlewares.js"],"names":["path","require","webpack","webpackDevMiddleware","webpackHotMiddleware","createWebpackMiddleware","compiler","publicPath","noInfo","silent","stats","module","exports","addDevMiddlewares","app","webpackConfig","middleware","output","use","fs","fileSystem","get","req","res","readFile","join","outputPath","err","file","sendStatus","send","toString"],"mappings":";;AAAA,IAAMA,IAAI,GAAGC,OAAO,CAAC,MAAD,CAApB;;AAEA,IAAMC,OAAO,GAAGD,OAAO,CAAC,SAAD,CAAvB;;AACA,IAAME,oBAAoB,GAAGF,OAAO,CAAC,wBAAD,CAApC;;AACA,IAAMG,oBAAoB,GAAGH,OAAO,CAAC,wBAAD,CAApC;;AAEA,SAASI,uBAAT,CAAiCC,QAAjC,EAA2CC,UAA3C,EAAuD;AACrD,SAAOJ,oBAAoB,CAACG,QAAD,EAAW;AACpCE,IAAAA,MAAM,EAAE,IAD4B;AAEpCD,IAAAA,UAAU,EAAVA,UAFoC;AAGpCE,IAAAA,MAAM,EAAE,IAH4B;AAIpCC,IAAAA,KAAK,EAAE;AAJ6B,GAAX,CAA3B;AAMD;;AAEDC,MAAM,CAACC,OAAP,GAAiB,SAASC,iBAAT,CAA2BC,GAA3B,EAAgCC,aAAhC,EAA+C;AAC9D,MAAMT,QAAQ,GAAGJ,OAAO,CAACa,aAAD,CAAxB;AACA,MAAMC,UAAU,GAAGX,uBAAuB,CACxCC,QADwC,EAExCS,aAAa,CAACE,MAAd,CAAqBV,UAFmB,CAA1C;AAKAO,EAAAA,GAAG,CAACI,GAAJ,CAAQF,UAAR;AACAF,EAAAA,GAAG,CAACI,GAAJ,CAAQd,oBAAoB,CAACE,QAAD,CAA5B,EAR8D,CAU9D;AACA;;AACA,MAAMa,EAAE,GAAGH,UAAU,CAACI,UAAtB;AAEAN,EAAAA,GAAG,CAACO,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAc;AACzBJ,IAAAA,EAAE,CAACK,QAAH,CAAYxB,IAAI,CAACyB,IAAL,CAAUnB,QAAQ,CAACoB,UAAnB,EAA+B,YAA/B,CAAZ,EAA0D,UAACC,GAAD,EAAMC,IAAN,EAAe;AACvE,UAAID,GAAJ,EAAS;AACPJ,QAAAA,GAAG,CAACM,UAAJ,CAAe,GAAf;AACD,OAFD,MAEO;AACLN,QAAAA,GAAG,CAACO,IAAJ,CAASF,IAAI,CAACG,QAAL,EAAT;AACD;AACF,KAND;AAOD,GARD;AASD,CAvBD","sourcesContent":["const path = require('path');\n\nconst webpack = require('webpack');\nconst webpackDevMiddleware = require('webpack-dev-middleware');\nconst webpackHotMiddleware = require('webpack-hot-middleware');\n\nfunction createWebpackMiddleware(compiler, publicPath) {\n  return webpackDevMiddleware(compiler, {\n    noInfo: true,\n    publicPath,\n    silent: true,\n    stats: 'errors-only',\n  });\n}\n\nmodule.exports = function addDevMiddlewares(app, webpackConfig) {\n  const compiler = webpack(webpackConfig);\n  const middleware = createWebpackMiddleware(\n    compiler,\n    webpackConfig.output.publicPath,\n  );\n\n  app.use(middleware);\n  app.use(webpackHotMiddleware(compiler));\n\n  // Since webpackDevMiddleware uses memory-fs internally to store build\n  // artifacts, we use it instead\n  const fs = middleware.fileSystem;\n\n  app.get('*', (req, res) => {\n    fs.readFile(path.join(compiler.outputPath, 'index.html'), (err, file) => {\n      if (err) {\n        res.sendStatus(404);\n      } else {\n        res.send(file.toString());\n      }\n    });\n  });\n};\n"],"file":"addDevMiddlewares.js"}