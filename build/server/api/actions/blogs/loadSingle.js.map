{"version":3,"sources":["../../../../../server/api/actions/blogs/loadSingle.js"],"names":["loadSingle","req","reqSecured","Promise","resolve","reject","then","user","redisKey","includeDeleted","admin","filter","ar","id","query","published","err"],"mappings":";;;;;;;;;AAAA;;AAEA;;AACA;;AAEe,SAASA,UAAT,CAAoBC,GAApB,EAAyB;AACtC,MAAMC,UAAU,GAAG,2BAAUD,GAAV,EAAe,EAAf,CAAnB;AACA,SAAO,IAAIE,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oCAAeH,UAAf,EAA2BI,IAA3B,CACE,UAAAC,IAAI,EAAI;AACNH,MAAAA,OAAO,CACL,4BAAgB;AACdI,QAAAA,QAAQ,EAAE,OADI;AAEdC,QAAAA,cAAc,EAAEF,IAAI,IAAIA,IAAI,CAACG,KAFf;AAGdC,QAAAA,MAAM,EAAE,gBAAAC,EAAE,EAAI;AACZ,cAAIA,EAAE,CAACC,EAAH,KAAUX,UAAU,CAACY,KAAX,CAAiBD,EAA/B,EAAmC;AACjC,mBAAO,KAAP;AACD;;AACD,cAAI,CAACD,EAAE,CAACG,SAAJ,KAAkB,CAACR,IAAD,IAAS,CAACA,IAAI,CAACG,KAAjC,CAAJ,EAA6C;AAC3C,mBAAO,KAAP;AACD;;AACD,iBAAO,IAAP;AACD;AAXa,OAAhB,CADK,CAAP;AAeD,KAjBH,EAkBE,UAAAM,GAAG;AAAA,aAAIX,MAAM,CAACW,GAAD,CAAV;AAAA,KAlBL;AAoBD,GArBM,CAAP;AAsBD","sourcesContent":["import { datumLoadSingle } from '../datum';\n\nimport authentication from 'utils/authentication';\nimport reqSecure from 'utils/reqSecure';\n\nexport default function loadSingle(req) {\n  const reqSecured = reqSecure(req, []);\n  return new Promise((resolve, reject) => {\n    authentication(reqSecured).then(\n      user => {\n        resolve(\n          datumLoadSingle({\n            redisKey: 'blogs',\n            includeDeleted: user && user.admin,\n            filter: ar => {\n              if (ar.id !== reqSecured.query.id) {\n                return false;\n              }\n              if (!ar.published && (!user || !user.admin)) {\n                return false;\n              }\n              return true;\n            },\n          }),\n        );\n      },\n      err => reject(err),\n    );\n  });\n}\n"],"file":"loadSingle.js"}