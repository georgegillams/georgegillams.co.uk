{"version":3,"sources":["../../../../../server/api/actions/make-payment/load.js"],"names":["loadSingle","req","reqSecured","stripePaymentsAllowedAttributes","Promise","resolve","reject","body","paymentId","then","payment","email","err"],"mappings":";;;;;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;AAEe,SAASA,UAAT,CAAoBC,GAApB,EAAyB;AACtC,MAAMC,UAAU,GAAG,2BAAUD,GAAV,EAAeE,2CAAf,CAAnB;AACA,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,0CAAqBJ,UAAU,CAACK,IAAX,CAAgBC,SAArC,EACGC,IADH,CACQ,UAAAC,OAAO,EAAI;AACf,iDAA0BA,OAA1B,EACGD,IADH,CACQ,YAAM;AACVJ,QAAAA,OAAO,mBACFK,OADE;AAELC,UAAAA,KAAK,EAAE;AAFF,WAAP;AAID,OANH,WAOS,UAAAC,GAAG,EAAI;AACZN,QAAAA,MAAM,CAACM,GAAD,CAAN;AACD,OATH;AAUD,KAZH,WAaS,UAAAA,GAAG,EAAI;AACZN,MAAAA,MAAM,CAACM,GAAD,CAAN;AACD,KAfH;AAgBD,GAjBM,CAAP;AAkBD","sourcesContent":["import reqSecure from 'utils/reqSecure';\nimport stripePaymentsAllowedAttributes from './stripePaymentsAllowedAttributes';\nimport getPaymentAndBalance from './getPaymentAndBalance';\nimport sendUnsentPaymentReceipts from './sendUnsentPaymentReceipts';\n\nexport default function loadSingle(req) {\n  const reqSecured = reqSecure(req, stripePaymentsAllowedAttributes);\n  return new Promise((resolve, reject) => {\n    getPaymentAndBalance(reqSecured.body.paymentId)\n      .then(payment => {\n        sendUnsentPaymentReceipts(payment)\n          .then(() => {\n            resolve({\n              ...payment,\n              email: 'REDACTED',\n            });\n          })\n          .catch(err => {\n            reject(err);\n          });\n      })\n      .catch(err => {\n        reject(err);\n      });\n  });\n}\n"],"file":"load.js"}