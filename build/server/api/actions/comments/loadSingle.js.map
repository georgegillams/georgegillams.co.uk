{"version":3,"sources":["../../../../../server/api/actions/comments/loadSingle.js"],"names":["loadSingle","req","reqSecured","commentsAllowedAttributes","Promise","resolve","reject","then","user","redisKey","includeDeleted","admin","filter","ar","id","query","err"],"mappings":";;;;;;;;;AAAA;;AAEA;;AAEA;;AACA;;AAEe,SAASA,UAAT,CAAoBC,GAApB,EAAyB;AACtC,MAAMC,UAAU,GAAG,2BAAUD,GAAV,EAAeE,qCAAf,CAAnB;AACA,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,oCAAeJ,UAAf,EAA2BK,IAA3B,CACE,UAAAC,IAAI,EAAI;AACNH,MAAAA,OAAO,CACL,4BAAgB;AACdI,QAAAA,QAAQ,EAAE,UADI;AAEdC,QAAAA,cAAc,EAAEF,IAAI,IAAIA,IAAI,CAACG,KAFf;AAGdC,QAAAA,MAAM,EAAE,gBAAAC,EAAE;AAAA,iBAAIA,EAAE,CAACC,EAAH,KAAUZ,UAAU,CAACa,KAAX,CAAiBD,EAA/B;AAAA;AAHI,OAAhB,CADK,CAAP;AAOD,KATH,EAUE,UAAAE,GAAG;AAAA,aAAIV,MAAM,CAACU,GAAD,CAAV;AAAA,KAVL;AAYD,GAbM,CAAP;AAcD","sourcesContent":["import { datumLoadSingle } from '../datum';\n\nimport commentsAllowedAttributes from './commentsAllowedAttributes';\n\nimport authentication from 'utils/authentication';\nimport reqSecure from 'utils/reqSecure';\n\nexport default function loadSingle(req) {\n  const reqSecured = reqSecure(req, commentsAllowedAttributes);\n  return new Promise((resolve, reject) => {\n    authentication(reqSecured).then(\n      user => {\n        resolve(\n          datumLoadSingle({\n            redisKey: 'comments',\n            includeDeleted: user && user.admin,\n            filter: ar => ar.id === reqSecured.query.id,\n          }),\n        );\n      },\n      err => reject(err),\n    );\n  });\n}\n"],"file":"loadSingle.js"}