{"version":3,"sources":["../../../../server/api/utils/assignTicket.js"],"names":["assignTicket","user","ticket","Promise","resolve","reject","redisKey","then","sessionData","session","sessionKey","userId","userProfile","id","userAuthenticatedTimestamp","Date","now","body"],"mappings":";;;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AACA;;AAEe,SAASA,YAAT,CAAsBC,IAAtB,EAA4BC,MAA5B,EAAoC;AACjD,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,0BAAU;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAV,EAAoCC,IAApC,CAAyC,UAAAC,WAAW,EAAI;AACtD,UAAMC,OAAO,GAAG,EAAhB;AACAA,MAAAA,OAAO,CAACC,UAAR,GAAqB,wBAArB;AACAD,MAAAA,OAAO,CAACE,MAAR,GAAiBC,WAAW,CAACC,EAA7B;AACAD,MAAAA,WAAW,CAACH,OAAZ,GAAsBA,OAAO,CAACC,UAA9B;AACAD,MAAAA,OAAO,CAACK,0BAAR,GAAqCC,IAAI,CAACC,GAAL,EAArC;AACA,8BAAY;AAAEV,QAAAA,QAAQ,EAAE;AAAZ,OAAZ,EAAsC;AAAEW,QAAAA,IAAI,EAAER;AAAR,OAAtC,EAAyDF,IAAzD,CAA8D,YAAM;AAClE;AACAH,QAAAA,OAAO,CAACQ,WAAD,CAAP;AACD,OAHD;AAID,KAVD;AAWD,GAZM,CAAP;AAaD","sourcesContent":["import { datumLoad, datumCreate } from '../actions/datum';\n\nimport { find } from 'utils/find';\nimport { INVALID_SESSION, INVALID_CREDENTIALS } from 'helpers/constants';\nimport { generateKey } from 'utils/hash';\nimport setContentLastUpdatedTimestamp from 'utils/setContentLastUpdatedTimestamp';\n\nexport default function assignTicket(user, ticket) {\n  return new Promise((resolve, reject) => {\n    datumLoad({ redisKey: 'sessions' }).then(sessionData => {\n      const session = {};\n      session.sessionKey = generateKey();\n      session.userId = userProfile.id;\n      userProfile.session = session.sessionKey;\n      session.userAuthenticatedTimestamp = Date.now();\n      datumCreate({ redisKey: 'sessions' }, { body: session }).then(() => {\n        setContentLastUpdatedTimestamp();\n        resolve(userProfile);\n      });\n    });\n  });\n}\n"],"file":"assignTicket.js"}