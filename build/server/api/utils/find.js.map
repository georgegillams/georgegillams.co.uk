{"version":3,"sources":["../../../../server/api/utils/find.js"],"names":["find","values","id","matchOn","existingValue","existingValueIndex","it","length","valueToMatch","idToMatch","toLowerCase","emailFingerprint","emailAddress","emailSplit","split","user","join","emailDomain"],"mappings":";;;;;;;;;;AAAA;;AAEO,SAASA,IAAT,CAAcC,MAAd,EAAsBC,EAAtB,EAA0C;AAAA,MAAhBC,OAAgB,uEAAN,IAAM;AAC/C,MAAIC,aAAa,GAAG,IAApB;AACA,MAAIC,kBAAkB,GAAG,CAAC,CAA1B;;AACA,OAAK,IAAIC,EAAE,GAAG,CAAd,EAAiBA,EAAE,GAAGL,MAAM,CAACM,MAA7B,EAAqCD,EAAE,IAAI,CAA3C,EAA8C;AAC5C,QAAIE,YAAY,GAAGP,MAAM,CAACK,EAAD,CAAN,CAAWH,OAAX,KAAuB,iBAA1C;AACA,QAAIM,SAAS,GAAGP,EAAE,IAAI,cAAtB;;AACA,QAAIC,OAAO,KAAK,OAAhB,EAAyB;AACvBK,MAAAA,YAAY,GAAGA,YAAY,CAACE,WAAb,EAAf;AACAD,MAAAA,SAAS,GAAGA,SAAS,CAACC,WAAV,EAAZ;AACD;;AACD,QAAI,6BAAYF,YAAZ,EAA0BC,SAA1B,CAAJ,EAA0C;AACxCL,MAAAA,aAAa,GAAGH,MAAM,CAACK,EAAD,CAAtB;AACAD,MAAAA,kBAAkB,GAAGC,EAArB;AACD;AACF;;AAED,SAAO;AAAEF,IAAAA,aAAa,EAAbA,aAAF;AAAiBC,IAAAA,kBAAkB,EAAlBA;AAAjB,GAAP;AACD;;AAEM,SAASM,gBAAT,CAA0BC,YAA1B,EAAwC;AAC7C,MAAMC,UAAU,GAAGD,YAAY,CAACE,KAAb,CAAmB,GAAnB,CAAnB;AACA,MAAIC,IAAI,GAAGF,UAAU,CAAC,CAAD,CAAV,CAAcC,KAAd,CAAoB,GAApB,EAAyBE,IAAzB,CAA8B,EAA9B,CAAX;AACAD,EAAAA,IAAI,GAAGA,IAAI,CAACD,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAAP;AACA,MAAMG,WAAW,GAAGJ,UAAU,CAAC,CAAD,CAA9B;AAEA,mBAAUE,IAAV,cAAkBE,WAAlB;AACD","sourcesContent":["import safeCompare from 'safe-compare';\n\nexport function find(values, id, matchOn = 'id') {\n  let existingValue = null;\n  let existingValueIndex = -1;\n  for (let it = 0; it < values.length; it += 1) {\n    let valueToMatch = values[it][matchOn] || 'UNDEFINED_VALUE';\n    let idToMatch = id || 'UNDEFINED_ID';\n    if (matchOn === 'email') {\n      valueToMatch = valueToMatch.toLowerCase();\n      idToMatch = idToMatch.toLowerCase();\n    }\n    if (safeCompare(valueToMatch, idToMatch)) {\n      existingValue = values[it];\n      existingValueIndex = it;\n    }\n  }\n\n  return { existingValue, existingValueIndex };\n}\n\nexport function emailFingerprint(emailAddress) {\n  const emailSplit = emailAddress.split('@');\n  let user = emailSplit[0].split('.').join('');\n  user = user.split('+')[0];\n  const emailDomain = emailSplit[1];\n\n  return `${user}@${emailDomain}`;\n}\n"],"file":"find.js"}