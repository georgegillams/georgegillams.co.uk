{"version":3,"sources":["../../../../server/api/utils/login.js"],"names":["login","reqSecured","userProfile","Promise","resolve","reject","redisKey","then","sessionData","session","sessionKey","userId","id","userAuthenticatedTimestamp","Date","now","body"],"mappings":";;;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AACA;;AAEe,SAASA,KAAT,CAAeC,UAAf,EAA2BC,WAA3B,EAAwC;AACrD,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtC,0BAAU;AAAEC,MAAAA,QAAQ,EAAE;AAAZ,KAAV,EAAoCC,IAApC,CAAyC,UAAAC,WAAW,EAAI;AACtD,UAAMC,OAAO,GAAG,EAAhB;AACAA,MAAAA,OAAO,CAACC,UAAR,GAAqB,wBAArB;AACAD,MAAAA,OAAO,CAACE,MAAR,GAAiBT,WAAW,CAACU,EAA7B;AACAV,MAAAA,WAAW,CAACO,OAAZ,GAAsBA,OAAO,CAACC,UAA9B;AACAD,MAAAA,OAAO,CAACI,0BAAR,GAAqCC,IAAI,CAACC,GAAL,EAArC;AACA,8BAAY;AAAET,QAAAA,QAAQ,EAAE;AAAZ,OAAZ,EAAsC;AAAEU,QAAAA,IAAI,EAAEP;AAAR,OAAtC,EAAyDF,IAAzD,CAA8D,YAAM;AAClE;AACAH,QAAAA,OAAO,CAACF,WAAD,CAAP;AACD,OAHD;AAID,KAVD;AAWD,GAZM,CAAP;AAaD","sourcesContent":["import { datumLoad, datumCreate } from '../actions/datum';\n\nimport { find } from 'utils/find';\nimport { INVALID_SESSION, INVALID_CREDENTIALS } from 'helpers/constants';\nimport { generateKey } from 'utils/hash';\nimport setContentLastUpdatedTimestamp from 'utils/setContentLastUpdatedTimestamp';\n\nexport default function login(reqSecured, userProfile) {\n  return new Promise((resolve, reject) => {\n    datumLoad({ redisKey: 'sessions' }).then(sessionData => {\n      const session = {};\n      session.sessionKey = generateKey();\n      session.userId = userProfile.id;\n      userProfile.session = session.sessionKey;\n      session.userAuthenticatedTimestamp = Date.now();\n      datumCreate({ redisKey: 'sessions' }, { body: session }).then(() => {\n        setContentLastUpdatedTimestamp();\n        resolve(userProfile);\n      });\n    });\n  });\n}\n"],"file":"login.js"}