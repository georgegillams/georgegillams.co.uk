(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{"./app/containers/Login/Container.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireWildcard.js"),r=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=r(n("./node_modules/@babel/runtime/helpers/extends.js")),a=r(n("./node_modules/@babel/runtime/helpers/jsx.js")),i=r(n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js")),u=r(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=r(n("./node_modules/@babel/runtime/helpers/createClass.js")),c=r(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),d=r(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=r(n("./node_modules/@babel/runtime/helpers/inherits.js")),g=s(n("./node_modules/react/index.js")),f=(r(n("./node_modules/prop-types/index.js")),n("./node_modules/react-helmet/lib/Helmet.js")),b=(s(n("./node_modules/bpk-component-image/index.js")),n("./node_modules/bpk-react-utils/index.js")),m=r(n("./app/containers/Login/Skeleton.js")),j=(n("./node_modules/gg-components/LoadingIndicator/index.js"),n("./node_modules/gg-components/Button/index.js"),n("./node_modules/gg-components/Typography/index.js")),O=(n("./node_modules/gg-components/Code/index.js"),n("./node_modules/gg-components/Auth/index.js")),h=n("./app/components/Forms/index.js"),x=n("./app/components/Sessions/index.js"),y=(n("./helpers/constants.js"),r(n("./app/containers/pages.scss"))),_=((0,b.cssModules)(y.default),(0,a.default)("br",{})),k=(0,a.default)(j.TextLink,{to:"/sign-up"},void 0,"Not yet got an account? Sign up here."),L=(0,a.default)(f.Helmet,{title:"Login"}),v=function(e){function t(){return(0,u.default)(this,t),(0,c.default)(this,(0,d.default)(t).apply(this,arguments))}return(0,p.default)(t,e),(0,l.default)(t,[{key:"render",value:function(){var e=this.props,t=e.cookiesAllowed,n=e.onCookiesAccepted,s=e.setCredentials,r=e.credentials,u=e.login,l=e.user,c=e.userLoading,d=e.userLoadError,p=e.loggingIn,f=e.logInSuccess,b=e.logInError,y=e.className,v=(0,i.default)(e,["cookiesAllowed","onCookiesAccepted","setCredentials","credentials","login","user","userLoading","userLoadError","loggingIn","logInSuccess","logInError","className"]),I=[];y&&I.push(y);var S=g.default.createElement("div",(0,o.default)({className:I.join(" ")},v),(0,a.default)(O.LoggedOutOnly,{user:l},void 0,(0,a.default)(j.Section,{name:"Login"},void 0,(0,a.default)(h.LoginForm,{disabled:p||f,credentials:r||{useMagicLink:!0},onDataChanged:s,onSubmit:u,presubmitText:f?"A magic login link has been sent to your email address. Please check your junk folder before requesting another.":null}),_,k)));return(0,a.default)(g.Fragment,{},void 0,L,(0,a.default)(x.CookiesOnly,{cookiesAccepted:t,onAccept:n}),(0,a.default)(O.LoadingCover,{loadingSkeleton:m.default,loading:!t||c,error:d},void 0,S),(0,a.default)(O.DebugObject,{debugTitle:"Login",debugObject:{cookiesAllowed:t,onCookiesAccepted:n,setCredentials:s,credentials:r,login:u,user:l,userLoading:c,loggingIn:p,logInSuccess:f,logInError:b}}))}}]),t}(g.default.Component);t.default=v,e.exports=t.default},"./app/containers/Login/actionMeta.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={key:"login",actionDefinitions:[{SET_CREDENTIALS:"tbd",attributes:["credentials"],stateMutations:{credentials:function(e){return e.credentials},loggingIn:!1,logInSuccess:!1}},{LOGIN:"tbd",attributes:[],stateMutations:{loggingIn:!0,logInError:null}},{LOGIN_REGISTER_SUCCESS:"tbd",attributes:[],stateMutations:{loggingIn:!1,logInSuccess:!0}},{LOGIN_REGISTER_ERROR:"tbd",attributes:["logInError"],stateMutations:{loggingIn:!1,logInSuccess:!1,logInError:function(e){return e.logInError}}}]};t.default=s,e.exports=t.default},"./app/containers/Login/index.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),r=s(n("./node_modules/@babel/runtime/helpers/defineProperty.js")),o=s(n("./app/containers/App/selectors.js")),a=s(n("./app/containers/App/actions.js")),i=n("./helpers/redux/index.js"),u=s(n("./app/containers/Login/actionMeta.js")),l=n("./app/containers/Login/redux-definitions.js"),c=s(n("./app/containers/Login/saga.js")),d=s(n("./app/containers/Login/Container.js"));function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=(0,i.composeContainer)(d.default,u.default.key,g({},l.selectors,{},o.default),g({},l.actions,{appActions:a.default}),l.reducer,c.default)},"./app/containers/Login/redux-definitions.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),r=s(n("./app/containers/Login/actionMeta.js")),o=s(n("./helpers/redux/index.js"));e.exports=(0,o.default)(r.default)},"./app/containers/Login/saga.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.doLogin=L,t.default=v;var r=s(n("./node_modules/@babel/runtime/regenerator/index.js")),o=s(n("./node_modules/@babel/runtime/helpers/defineProperty.js")),a=n("./app/containers/Login/redux-definitions.js"),i=n("./node_modules/redux-saga/dist/redux-saga-effects-npm-proxy.cjs.js"),u=n("./app/containers/App/actions.js"),l=n("./app/containers/RequestStatusWrapper/actions.js"),c=n("./helpers/constants.js"),d=n("./app/containers/App/selectors.js"),p=s(n("./app/utils/request.js")),g=r.default.mark(L),f=r.default.mark(v);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=a.constants.LOGIN,O=a.actions.loginRegisterSuccess,h=a.actions.loginRegisterError,x=a.selectors.makeSelectCredentials,y={type:"success",message:"Magic link sent!"},_={type:"success",message:"Login successful!"},k={type:"error",message:"Login failed. Please check entered details."};function L(){var e,t,n,s;return r.default.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,(0,i.select)(x());case 2:return e=r.sent,r.next=5,(0,i.select)((0,d.makeSelectLoginRedirect)());case 5:return t=r.sent,n="".concat(c.API_ENDPOINT).concat(e.useMagicLink?"/getmagiclink":"/login"),r.prev=7,r.next=10,(0,i.call)(p.default,n,{method:"POST",body:JSON.stringify(m({},e,{loginRedirect:t})),headers:{"Content-Type":"application/json"}});case 10:if(!(s=r.sent).error){r.next=18;break}return r.next=14,(0,i.put)(h(s));case 14:return r.next=16,(0,i.put)((0,l.pushMessage)(k));case 16:r.next=25;break;case 18:return r.next=20,(0,i.put)(O());case 20:return r.next=22,(0,i.put)((0,l.pushMessage)(e.useMagicLink?y:_));case 22:if(e.useMagicLink){r.next=25;break}return r.next=25,(0,i.put)((0,u.setUser)(s));case 25:r.next=33;break;case 27:return r.prev=27,r.t0=r.catch(7),r.next=31,(0,i.put)(h(r.t0));case 31:return r.next=33,(0,i.put)((0,l.pushMessage)(c.COMMUNICATION_ERROR_MESSAGE));case 33:case"end":return r.stop()}}),g,null,[[7,27]])}function v(){return r.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,i.takeLatest)(j,L);case 2:case"end":return e.stop()}}),f)}}}]);