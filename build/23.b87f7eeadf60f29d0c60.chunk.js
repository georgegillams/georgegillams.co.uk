(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"./app/containers/MonzoPots/Container.js":function(e,t,a){"use strict";var s=a("./node_modules/@babel/runtime/helpers/interopRequireWildcard.js"),n=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n(a("./node_modules/@babel/runtime/helpers/extends.js")),r=n(a("./node_modules/@babel/runtime/helpers/jsx.js")),u=n(a("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js")),d=n(a("./node_modules/@babel/runtime/helpers/classCallCheck.js")),i=n(a("./node_modules/@babel/runtime/helpers/createClass.js")),l=n(a("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),c=n(a("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),p=n(a("./node_modules/@babel/runtime/helpers/assertThisInitialized.js")),f=n(a("./node_modules/@babel/runtime/helpers/inherits.js")),m=n(a("./node_modules/@babel/runtime/helpers/defineProperty.js")),b=s(a("./node_modules/react/index.js")),g=(n(a("./node_modules/prop-types/index.js")),a("./node_modules/react-helmet/lib/Helmet.js")),y=(s(a("./node_modules/bpk-component-image/index.js")),a("./node_modules/gg-components/Input/index.js")),h=a("./node_modules/bpk-react-utils/index.js"),x=a("./helpers/objects.js"),P=(n(a("./app/containers/MonzoPots/Skeleton.js")),n(a("./helpers/HelperFunctions.js")),a("./node_modules/gg-components/MoneyPot/index.js")),_=a("./node_modules/gg-components/Button/index.js"),j=a("./node_modules/gg-components/Typography/index.js"),S=(a("./node_modules/gg-components/Auth/index.js"),a("./node_modules/gg-components/FormBuilder/index.js")),E=n(a("./app/containers/pages.scss")),O=(0,h.cssModules)(E.default),M=(0,r.default)(g.Helmet,{title:"My monzo pots"}),T=(0,r.default)("br",{}),w=(0,r.default)("br",{}),k=(0,r.default)("br",{}),R=(0,r.default)("br",{}),D=function(e){function t(e){var a;return(0,d.default)(this,t),a=(0,l.default)(this,(0,c.default)(t).call(this,e)),(0,m.default)((0,p.default)(a),"loadPotData",(function(e){a.props.loadPots(e),a.props.loadTransactions(e)})),a.state={},a}return(0,f.default)(t,e),(0,i.default)(t,[{key:"render",value:function(){var e=this,t=this.props,a=t.user,s=(t.loadPots,t.loadTransactions,t.password),n=t.pots,d=(t.loadingPots,t.loadPotsSuccess,t.loadPotsError,t.transactions),i=(t.loadingTransactions,t.loadTransactionsSuccess,t.loadTransactionsError,t.addKey),l=t.addKeyLoading,c=(t.addKeySuccess,t.addKeyError,t.className),p=(0,u.default)(t,["user","loadPots","loadTransactions","password","pots","loadingPots","loadPotsSuccess","loadPotsError","transactions","loadingTransactions","loadTransactionsSuccess","loadTransactionsError","addKey","addKeyLoading","addKeySuccess","addKeyError","className"]),f=a&&a.admin,m=[];c&&m.push(c);var g=n;return n&&n.map&&d&&d.map&&(g=(0,x.associate)(n,d,"name","name","transactionalData")),b.default.createElement("div",(0,o.default)({className:m.join(" ")},p),M,(0,r.default)(j.Section,{},void 0,(0,r.default)(j.Section,{name:"Monzo pot tracking ðŸ’³"},void 0,!g&&(0,r.default)(b.Fragment,{},void 0,(0,r.default)("label",{htmlFor:"password",className:O("forms__label")},void 0,"Password"),(0,r.default)(y.Input,{id:"password",className:O("pages__component"),type:"password",name:"password",value:s||"",onChange:function(t){e.loadPotData(t.target.value)},placeholder:"Password"})),g&&g.map&&(0,r.default)(_.Button,{onClick:function(){e.loadPotData(s)}},void 0,"Refresh"),T,w,g&&g.map&&g.map((function(e){return(0,r.default)(b.Fragment,{},void 0,(0,r.default)(P.MoneyPot,{name:e.name,balance:e.balance,goalAmount:e.goalAmount,markerPosition:e.percentageExpected>0?e.percentageExpected:null,shortfall:e.shortfall,className:O("pages__degree-module")}),(0,r.default)(j.SubSection,{noPadding:!0,anchor:!1},void 0,"Last deposit:"," ",e.transactionalData&&e.transactionalData.lastDeposit?"Â£".concat(e.transactionalData.lastDeposit.amount/100," - ").concat(e.transactionalData.lastDeposit.time):"loading..."),(0,r.default)(j.SubSection,{noPadding:!0,anchor:!1},void 0,"Last withdrawal:"," ",e.transactionalData&&e.transactionalData.lastWithdrawal?"Â£".concat(e.transactionalData.lastWithdrawal.amount/100," - ").concat(e.transactionalData.lastWithdrawal.time):"loading..."),k,R)})),f&&(0,r.default)(S.FormBuilder,{disabled:l,entity:this.state.keyData||{},submitLabel:"Set key",formFields:[{id:"key",name:"Key",show:!0,type:"password"}],onDataChanged:function(t){e.setState({keyData:t})},onSubmit:function(){i(e.state.keyData.key)}}))))}}]),t}(b.default.Component);t.default=D,D.defaultProps={user:null,loading:!1,loadPotsError:null,blog:null,filter:null,linkPrefix:"",className:null},e.exports=t.default},"./app/containers/MonzoPots/actionMeta.js":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={key:"monzo",actionDefinitions:[{LOAD_POTS:"tbd",attributes:["password"],stateMutations:{password:function(e){return e.password},loadingPots:!0,loadPotsError:null}},{LOAD_POTS_REGISTER_SUCCESS:"tbd",attributes:["pots"],stateMutations:{loadingPots:!1,loadPotsSuccess:!0,pots:function(e){return e.pots}}},{LOAD_POTS_REGISTER_ERROR:"tbd",attributes:["loadPotsError"],stateMutations:{loadingPots:!1,loadPotsSuccess:!1,loadPotsError:function(e){return e.loadPotsError}}},{LOAD_TRANSACTIONS:"tbd",attributes:["password"],password:function(e){return e.password},stateMutations:{loadingTransactions:!0,loadTransactionsError:null}},{LOAD_TRANSACTIONS_REGISTER_SUCCESS:"tbd",attributes:["transactions"],stateMutations:{loadingTransactions:!1,loadTransactionsSuccess:!0,transactions:function(e){return e.transactions}}},{LOAD_TRANSACTIONS_REGISTER_ERROR:"tbd",attributes:["loadTransactionsError"],stateMutations:{loadingTransactions:!1,loadTransactionsSuccess:!1,loadTransactionsError:function(e){return e.loadTransactionsError}}},{ADD_KEY:"tbd",attributes:["key"],stateMutations:{key:function(e){return e.key},addKeyLoading:!0,addKeyError:null}},{ADD_KEY_REGISTER_SUCCESS:"tbd",attributes:[],stateMutations:{addKeyLoading:!1,addKeySuccess:!0}},{ADD_KEY_REGISTER_ERROR:"tbd",attributes:["setKeyError"],stateMutations:{addKeyError:function(e){return e.addKeyError},addKeyLoading:!1,addKeySuccess:!1}}]};t.default=s,e.exports=t.default},"./app/containers/MonzoPots/index.js":function(e,t,a){"use strict";var s=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=s(a("./node_modules/@babel/runtime/helpers/defineProperty.js")),o=s(a("./app/containers/App/selectors.js")),r=a("./helpers/redux/index.js"),u=s(a("./app/containers/MonzoPots/actionMeta.js")),d=a("./app/containers/MonzoPots/redux-definitions.js"),i=s(a("./app/containers/MonzoPots/saga.js")),l=s(a("./app/containers/MonzoPots/Container.js"));function c(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,s)}return a}function p(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?c(Object(a),!0).forEach((function(t){(0,n.default)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):c(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}e.exports=(0,r.composeContainer)(l.default,u.default.key,p({},d.selectors,{},o.default),p({},d.actions),d.reducer,i.default)},"./app/containers/MonzoPots/redux-definitions.js":function(e,t,a){"use strict";var s=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),n=s(a("./app/containers/MonzoPots/actionMeta.js")),o=s(a("./helpers/redux/index.js"));e.exports=(0,o.default)(n.default)},"./app/containers/MonzoPots/saga.js":function(e,t,a){"use strict";var s=a("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.doLoadTransactions=w,t.doLoadPots=k,t.doAddKey=R,t.default=D;var n=s(a("./node_modules/@babel/runtime/regenerator/index.js")),o=a("./app/containers/MonzoPots/redux-definitions.js"),r=a("./node_modules/redux-saga/dist/redux-saga-effects-npm-proxy.cjs.js"),u=a("./helpers/constants.js"),d=a("./app/containers/RequestStatusWrapper/actions.js"),i=s(a("./app/utils/request.js")),l=n.default.mark(w),c=n.default.mark(k),p=n.default.mark(R),f=n.default.mark(D),m=o.actions.loadPotsRegisterSuccess,b=o.actions.loadPotsRegisterError,g=o.actions.loadTransactionsRegisterSuccess,y=o.actions.loadTransactionsRegisterError,h=o.actions.addKeyRegisterSuccess,x=o.actions.addKeyRegisterError,P=o.constants.LOAD_POTS,_=o.constants.LOAD_TRANSACTIONS,j=o.constants.ADD_KEY,S=o.selectors.makeSelectPassword,E=o.selectors.makeSelectKey,O={type:"success",message:"Monzo pot data loaded."},M={type:"success",message:"Key set!"},T={type:"error",message:"Could not set key."};function w(){var e,t,a;return n.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,r.select)(S());case 2:if(e=s.sent,t="".concat(u.API_ENDPOINT,"/monzo/loadLatestTransactions"),!(e.length<5)){s.next=6;break}return s.abrupt("return");case 6:return s.prev=6,s.next=9,(0,r.call)(i.default,t,{method:"POST",body:JSON.stringify({password:e}),headers:{"Content-Type":"application/json"}});case 9:if(!(a=s.sent).error){s.next=17;break}return s.next=13,(0,r.put)(y(a));case 13:return s.next=15,(0,r.put)((0,d.pushMessage)({type:"error",message:a.errorMessage}));case 15:s.next=24;break;case 17:if(!a.warning){s.next=22;break}return s.next=20,(0,r.put)((0,d.pushMessage)({type:"warn",message:a.warningMessage}));case 20:s.next=24;break;case 22:return s.next=24,(0,r.put)(g(a));case 24:s.next=32;break;case 26:return s.prev=26,s.t0=s.catch(6),s.next=30,(0,r.put)(y(s.t0));case 30:return s.next=32,(0,r.put)((0,d.pushMessage)(u.COMMUNICATION_ERROR_MESSAGE));case 32:case"end":return s.stop()}}),l,null,[[6,26]])}function k(){var e,t,a;return n.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,r.select)(S());case 2:if(e=s.sent,t="".concat(u.API_ENDPOINT,"/monzo/loadPots"),!(e.length<5)){s.next=6;break}return s.abrupt("return");case 6:return s.prev=6,s.next=9,(0,r.call)(i.default,t,{method:"POST",body:JSON.stringify({password:e}),headers:{"Content-Type":"application/json"}});case 9:if(!(a=s.sent).error){s.next=17;break}return s.next=13,(0,r.put)(b(a));case 13:return s.next=15,(0,r.put)((0,d.pushMessage)({type:"error",message:a.errorMessage}));case 15:s.next=26;break;case 17:if(!a.warning){s.next=22;break}return s.next=20,(0,r.put)((0,d.pushMessage)({type:"warn",message:a.warningMessage}));case 20:s.next=26;break;case 22:return s.next=24,(0,r.put)(m(a));case 24:return s.next=26,(0,r.put)((0,d.pushMessage)(O));case 26:s.next=34;break;case 28:return s.prev=28,s.t0=s.catch(6),s.next=32,(0,r.put)(b(s.t0));case 32:return s.next=34,(0,r.put)((0,d.pushMessage)(u.COMMUNICATION_ERROR_MESSAGE));case 34:case"end":return s.stop()}}),c,null,[[6,28]])}function R(){var e,t,a;return n.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,r.select)(E());case 2:return e=s.sent,t="".concat(u.API_ENDPOINT,"/monzo/setKey"),s.prev=4,s.next=7,(0,r.call)(i.default,t,{method:"POST",body:JSON.stringify({key:e}),headers:{"Content-Type":"application/json"}});case 7:if(!(a=s.sent).error){s.next=15;break}return s.next=11,(0,r.put)((0,d.pushMessage)(T));case 11:return s.next=13,(0,r.put)(x(a));case 13:s.next=19;break;case 15:return s.next=17,(0,r.put)((0,d.pushMessage)(M));case 17:return s.next=19,(0,r.put)(h(a));case 19:s.next=25;break;case 21:return s.prev=21,s.t0=s.catch(4),s.next=25,(0,r.put)((0,d.pushMessage)(u.COMMUNICATION_ERROR_MESSAGE));case 25:case"end":return s.stop()}}),p,null,[[4,21]])}function D(){return n.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,r.takeLatest)(P,k);case 2:return e.next=4,(0,r.takeLatest)(_,w);case 4:return e.next=6,(0,r.takeLatest)(j,R);case 6:case"end":return e.stop()}}),f)}}}]);