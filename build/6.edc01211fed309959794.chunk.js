(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"./app/containers/PaymentForm/Container.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireWildcard.js"),a=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("./node_modules/@babel/runtime/helpers/extends.js")),o=a(n("./node_modules/@babel/runtime/helpers/jsx.js")),d=a(n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js")),u=a(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),l=a(n("./node_modules/@babel/runtime/helpers/createClass.js")),i=a(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),c=a(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),m=a(n("./node_modules/@babel/runtime/helpers/inherits.js")),p=s(n("./node_modules/react/index.js")),y=(a(n("./node_modules/prop-types/index.js")),n("./node_modules/bpk-react-utils/index.js")),f=n("./node_modules/gg-components/FormBuilder/index.js"),P=n("./node_modules/gg-components/Auth/index.js"),b=n("./node_modules/gg-components/Button/index.js"),_=n("./node_modules/gg-components/Checkbox/index.js"),j=n("./node_modules/gg-components/Typography/index.js"),g=a(n("./app/containers/pages.scss")),h=n("./helpers/constants.js"),x=((0,y.cssModules)(g.default),(0,o.default)("br",{})),E=(0,o.default)("br",{}),S=(0,o.default)("br",{}),v=(0,o.default)("br",{}),M=function(e){function t(e){var n;return(0,u.default)(this,t),(n=(0,i.default)(this,(0,c.default)(t).call(this,e))).state={filterDeleted:!0},n}return(0,m.default)(t,e),(0,l.default)(t,[{key:"componentDidMount",value:function(){this.props.loadPayments()}},{key:"render",value:function(){var e=this,t=this.props,n=t.user,s=t.addPayment,a=t.addPaymentLoading,u=(t.addPaymentSuccess,t.addPaymentErrored,t.payments),l=t.loadPayments,i=(t.loadingPayments,t.loadPaymentsSuccess,t.loadPaymentsError,t.deletePayment),c=(t.deletePaymentLoading,t.deletePaymentSuccess,t.deletePaymentError,t.className),m=(0,d.default)(t,["user","addPayment","addPaymentLoading","addPaymentSuccess","addPaymentErrored","payments","loadPayments","loadingPayments","loadPaymentsSuccess","loadPaymentsError","deletePayment","deletePaymentLoading","deletePaymentSuccess","deletePaymentError","className"]),y=[];c&&y.push(c);var g=n&&n.admin,M=g&&u&&u.length>0,R=u;return R&&this.state.filterDeleted&&(R=R.filter((function(e){return!e.deleted}))),p.default.createElement("div",(0,r.default)({className:y.join(" ")},m),(0,o.default)(f.FormBuilder,{presubmitText:"Your email will be used only to send a payment receipt.",disabled:a,entity:this.state.newPayment||{},submitLabel:"Continue to payment",formFields:[{id:"amount",name:"Amount (GBP)",show:!0,validationRegex:h.DECIMAL_REGEX},{id:"email",name:"Email",show:!0,validationRegex:h.EMAIL_REGEX}],onDataChanged:function(t){e.setState({newPayment:t})},onSubmit:function(){s(e.state.newPayment)}}),g&&(0,o.default)(j.Section,{name:"Admin - payments"},void 0,(0,o.default)(b.Button,{onClick:function(){l()}},void 0,"Reload"),x,E,(0,o.default)(_.Checkbox,{label:"Show deleted",name:"filterDeleted",checked:!this.state.filterDeleted,onChange:function(t){e.setState({filterDeleted:!t.target.checked})}}),S,v,M&&R.map((function(e){return(0,o.default)(p.Fragment,{},void 0,(0,o.default)(P.APIEntity,{name:"more",entityType:"Payment",entity:e}),(0,o.default)(b.Button,{destructive:!0,onClick:function(){i(e)}},void 0,"Delete"))}))))}}]),t}(p.default.Component);t.default=M,M.defaultProps={user:null,loading:!1,error:null,blog:null,filter:null,paymentPrefix:"",className:null},e.exports=t.default},"./app/containers/PaymentForm/actionMeta.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s={key:"payment-form",actionDefinitions:[{LOAD_PAYMENTS:"tbd",attributes:[],stateMutations:{loadingPayments:!0,loadPaymentsError:null}},{LOAD_PAYMENTS_REGISTER_SUCCESS:"tbd",attributes:["payments"],stateMutations:{loadingPayments:!1,loadPaymentsSuccess:!0,payments:function(e){return e.payments}}},{LOAD_PAYMENTS_REGISTER_ERROR:"tbd",attributes:["loadPaymentsError"],stateMutations:{loadingPayments:!1,loadPaymentsSuccess:!1,loadPaymentsError:function(e){return e.loadPaymentsError}}},{ADD_PAYMENT:"tbd",attributes:["paymentDefinition"],stateMutations:{paymentDefinition:function(e){return e.paymentDefinition},addPaymentLoading:!0,addPaymentError:null}},{ADD_PAYMENT_REGISTER_SUCCESS:"tbd",attributes:[],stateMutations:{addPaymentLoading:!1,addPaymentSuccess:!0}},{ADD_PAYMENT_REGISTER_ERROR:"tbd",attributes:["addPaymentError"],stateMutations:{addPaymentError:function(e){return e.addPaymentError},addPaymentLoading:!1,addPaymentSuccess:!1}},{DELETE_PAYMENT:"tbd",attributes:["paymentToDelete"],stateMutations:{paymentToDelete:function(e){return e.paymentToDelete},deletePaymentLoading:!0,deletePaymentError:null}},{DELETE_PAYMENT_REGISTER_SUCCESS:"tbd",attributes:[],stateMutations:{deletePaymentLoading:!1,deletePaymentSuccess:!0}},{DELETE_PAYMENT_REGISTER_ERROR:"tbd",attributes:["deletePaymentError"],stateMutations:{deltePaymentError:function(e){return e.addPaymentError},deltePaymentLoading:!1,deltePaymentSuccess:!1}}]};t.default=s,e.exports=t.default},"./app/containers/PaymentForm/index.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=s(n("./node_modules/@babel/runtime/helpers/defineProperty.js")),r=s(n("./app/containers/App/selectors.js")),o=n("./helpers/redux/index.js"),d=s(n("./app/containers/PaymentForm/actionMeta.js")),u=n("./app/containers/PaymentForm/redux-definitions.js"),l=s(n("./app/containers/PaymentForm/saga.js")),i=s(n("./app/containers/PaymentForm/Container.js"));function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}e.exports=(0,o.composeContainer)(i.default,d.default.key,m({},u.selectors,{},r.default),m({},u.actions),u.reducer,l.default)},"./app/containers/PaymentForm/redux-definitions.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js"),a=s(n("./app/containers/PaymentForm/actionMeta.js")),r=s(n("./helpers/redux/index.js"));e.exports=(0,r.default)(a.default)},"./app/containers/PaymentForm/saga.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.doLoadPayments=k,t.doAddPayment=O,t.doDeletePayment=D,t.default=T;var a=s(n("./node_modules/@babel/runtime/regenerator/index.js")),r=n("./app/containers/PaymentForm/redux-definitions.js"),o=n("./node_modules/redux-saga/dist/redux-saga-effects-npm-proxy.cjs.js"),d=n("./helpers/constants.js"),u=n("./app/containers/RequestStatusWrapper/actions.js"),l=s(n("./app/utils/request.js")),i=a.default.mark(k),c=a.default.mark(O),m=a.default.mark(D),p=a.default.mark(T),y=r.constants.LOAD_PAYMENTS,f=r.constants.ADD_PAYMENT,P=r.constants.DELETE_PAYMENT,b=r.actions.loadPayments,_=r.actions.loadPaymentsRegisterSuccess,j=r.actions.loadPaymentsRegisterError,g=r.actions.addPaymentRegisterSuccess,h=r.actions.addPaymentRegisterError,x=r.actions.deletePaymentRegisterSuccess,E=r.actions.deletePaymentRegisterError,S=r.selectors.makeSelectPaymentDefinition,v=r.selectors.makeSelectPaymentToDelete,M={type:"success",message:"Payment started."},R={type:"success",message:"Payment deleted."};function k(){var e,t;return a.default.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e="".concat(d.API_ENDPOINT,"/payments/load"),n.prev=1,n.next=4,(0,o.call)(l.default,e,{method:"GET",body:JSON.stringify(),headers:{"Content-Type":"application/json"}});case 4:if(!(t=n.sent).error){n.next=10;break}return n.next=8,(0,o.put)(j(t));case 8:n.next=12;break;case 10:return n.next=12,(0,o.put)(_(t));case 12:n.next=21;break;case 14:return n.prev=14,n.t0=n.catch(1),console.error(n.t0),n.next=19,(0,o.put)(j(n.t0));case 19:return n.next=21,(0,o.put)((0,u.pushMessage)(d.COMMUNICATION_ERROR_MESSAGE));case 21:case"end":return n.stop()}}),i,null,[[1,14]])}function O(){var e,t,n;return a.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.t0=JSON,s.t1=JSON,s.next=4,(0,o.select)(S());case 4:return s.t2=s.sent,s.t3=s.t1.stringify.call(s.t1,s.t2),e=s.t0.parse.call(s.t0,s.t3),t="".concat(d.API_ENDPOINT,"/payments/create"),e.amount=100*e.amount,s.prev=9,s.next=12,(0,o.call)(l.default,t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 12:if(!(n=s.sent).error){s.next=20;break}return s.next=16,(0,o.put)(h(n));case 16:return s.next=18,(0,o.put)((0,u.pushMessage)({type:"error",message:n.errorMessage}));case 18:s.next=30;break;case 20:if(!n.warning){s.next=25;break}return s.next=23,(0,o.put)((0,u.pushMessage)({type:"warn",message:n.warningMessage}));case 23:s.next=30;break;case 25:return s.next=27,(0,o.put)(g(n));case 27:return s.next=29,(0,o.put)((0,u.pushMessage)(M));case 29:window.location="/payments/make-payment/".concat(n.id);case 30:s.next=38;break;case 32:return s.prev=32,s.t4=s.catch(9),s.next=36,(0,o.put)(h(s.t4));case 36:return s.next=38,(0,o.put)((0,u.pushMessage)(d.COMMUNICATION_ERROR_MESSAGE));case 38:case"end":return s.stop()}}),c,null,[[9,32]])}function D(){var e,t,n;return a.default.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:return s.next=2,(0,o.select)(v());case 2:return e=s.sent,t="".concat(d.API_ENDPOINT,"/payments/remove"),s.prev=4,s.next=7,(0,o.call)(l.default,t,{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}});case 7:if(!(n=s.sent).error){s.next=15;break}return s.next=11,(0,o.put)(h(n));case 11:return s.next=13,(0,o.put)((0,u.pushMessage)({type:"error",message:n.errorMessage}));case 13:s.next=26;break;case 15:if(!n.warning){s.next=20;break}return s.next=18,(0,o.put)((0,u.pushMessage)({type:"warn",message:n.warningMessage}));case 18:s.next=26;break;case 20:return s.next=22,(0,o.put)(x(n));case 22:return s.next=24,(0,o.put)((0,u.pushMessage)(R));case 24:return s.next=26,(0,o.put)(b());case 26:s.next=34;break;case 28:return s.prev=28,s.t0=s.catch(4),s.next=32,(0,o.put)(E(s.t0));case 32:return s.next=34,(0,o.put)((0,u.pushMessage)(d.COMMUNICATION_ERROR_MESSAGE));case 34:case"end":return s.stop()}}),m,null,[[4,28]])}function T(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,o.takeLatest)(y,k);case 2:return e.next=4,(0,o.takeLatest)(f,O);case 4:return e.next=6,(0,o.takeLatest)(P,D);case 6:case"end":return e.stop()}}),p)}},"./app/containers/Payments/Container.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n("./node_modules/@babel/runtime/helpers/jsx.js")),r=s(n("./node_modules/@babel/runtime/helpers/extends.js")),o=s(n("./node_modules/@babel/runtime/helpers/objectWithoutProperties.js")),d=s(n("./node_modules/@babel/runtime/helpers/classCallCheck.js")),u=s(n("./node_modules/@babel/runtime/helpers/createClass.js")),l=s(n("./node_modules/@babel/runtime/helpers/possibleConstructorReturn.js")),i=s(n("./node_modules/@babel/runtime/helpers/getPrototypeOf.js")),c=s(n("./node_modules/@babel/runtime/helpers/inherits.js")),m=s(n("./node_modules/react/index.js")),p=(s(n("./node_modules/prop-types/index.js")),n("./node_modules/react-helmet/lib/Helmet.js")),y=n("./node_modules/bpk-react-utils/index.js"),f=n("./node_modules/gg-components/Typography/index.js"),P=(n("./node_modules/gg-components/Code/index.js"),n("./node_modules/gg-components/Button/index.js"),n("./helpers/constants.js"),s(n("./app/containers/Payments/payments.scss"))),b=s(n("./app/containers/PaymentForm/index.js")),_=((0,y.cssModules)(P.default),(0,a.default)(p.Helmet,{title:"Payments"})),j=(0,a.default)(f.Section,{name:"Send me money"},void 0,(0,a.default)(b.default,{})),g=function(e){function t(){return(0,d.default)(this,t),(0,l.default)(this,(0,i.default)(t).apply(this,arguments))}return(0,c.default)(t,e),(0,u.default)(t,[{key:"render",value:function(){var e=this.props,t=e.className,n=(0,o.default)(e,["className"]),s=[];return t&&s.push(t),m.default.createElement("div",(0,r.default)({className:s.join(" ")},n),_,j)}}]),t}(m.default.Component);t.default=g,e.exports=t.default},"./app/containers/Payments/index.js":function(e,t,n){"use strict";var s=n("./node_modules/@babel/runtime/helpers/interopRequireDefault.js");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=s(n("./app/containers/Payments/Container.js")).default;t.default=a,e.exports=t.default},"./app/containers/Payments/payments.scss":function(e,t,n){var s=n("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),a=n("./node_modules/css-loader/dist/cjs.js?!./node_modules/sass-loader/dist/cjs.js!./app/containers/Payments/payments.scss");"string"==typeof(a=a.__esModule?a.default:a)&&(a=[[e.i,a,""]]);var r={insert:"head",singleton:!1},o=(s(e.i,a,r),a.locals?a.locals:{});e.exports=o},"./node_modules/css-loader/dist/cjs.js?!./node_modules/sass-loader/dist/cjs.js!./app/containers/Payments/payments.scss":function(e,t,n){(t=n("./node_modules/css-loader/dist/runtime/api.js")(!1)).push([e.i,"@keyframes payments__bpk-keyframe-spin___TkJgh{100%{transform:rotate(1turn)}}.payments__payments__inline___3Ccf_{display:flex;align-items:center}\n",""]),t.locals={payments__inline:"payments__payments__inline___3Ccf_","bpk-keyframe-spin":"payments__bpk-keyframe-spin___TkJgh"},e.exports=t}}]);